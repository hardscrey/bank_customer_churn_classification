# Bank-Customer-Churn-Prediction

## –û–ø–∏—Å–∞–Ω–∏–µ
–ü—Ä–æ–µ–∫—Ç –ø–æ—Å–≤—è—â—ë–Ω –∞–Ω–∞–ª–∏–∑—É –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–∞–Ω–∫–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—é –∏—Ö –æ—Ç—Ç–æ–∫–∞ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.
–ó–∞–¥–∞—á–∞ ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å, –ø–æ–∫–∏–Ω–µ—Ç –ª–∏ –∫–ª–∏–µ–Ω—Ç –±–∞–Ω–∫, –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

–ü–µ—Ä–µ—Ö–æ–¥ –∫ [**–∏—Å—Ç–æ—á–Ω–∏–∫—É –¥–∞–Ω–Ω—ã—Ö**](data/README.md)

–ü–µ—Ä–µ—Ö–æ–¥ –∫ [**–ø—Ä–æ–µ–∫—Ç—É .ipynb**](bank_customer_churn_prediction.ipynb)
## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- EDA –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- Phik –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –∏ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ (downsampling)
- –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π: Logistic Regression, RandomForest, XGBoost
- –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ GridSearchCV
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ train/test –º–µ—Ç—Ä–∏–∫, ROC –∏ PR –∫—Ä–∏–≤—ã–µ
- SHAP-–∞–Ω–∞–ª–∏–∑ –¥–ª—è –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –∏ –∏—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã

–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –ø—Ä–æ–µ–∫—Ç–∞: [–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è](images/), [–º–æ–¥–µ–ª–∏](models/).
## –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: **XGBoost (AUC ‚âà 0.87)** (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ [–ú–æ–¥–µ–ª–µ–π](model_comparison/final_model_metrics.csv))
- –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã –æ—Ç—Ç–æ–∫–∞:
  - `Age` ‚Äî —Ä–∏—Å–∫ –æ—Ç—Ç–æ–∫–∞ —Ä–∞—Å—Ç—ë—Ç —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º.
  - `NumOfProducts` ‚Äî –∫–ª–∏–µ–Ω—Ç—ã —Å 3‚Äì4 –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ —É—Ö–æ–¥—è—Ç —á–∞—â–µ.
  - `IsActiveMember` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ —Å–∏–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫.
  - `BalanceGeoDiff` ‚Äî –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ —Å—Ç—Ä–∞–Ω–µ.

## –í–∞–∂–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏
[Feature Importance](images/feature_importance.png)

[SHAP summary](images/shap_summary.png)

[ROC Curve](images/roc_curve.png)

[Correlation Heatmap](images/correlation_heatmap.png)

## üí° –í—ã–≤–æ–¥—ã
- –ù–∞ –æ—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤–ª–∏—è—é—Ç –≤–æ–∑—Ä–∞—Å—Ç, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤.
- –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å RandomForest –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≥–Ω–æ–∑–∞.


# bank_customer_churn-prediction

## üìò –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã –±–∞–Ω–∫–∞ –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â—É—é, –ø–æ–∫–∏–Ω–µ—Ç –ª–∏ –∫–ª–∏–µ–Ω—Ç –±–∞–Ω–∫.  
–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –≤—ã—è–≤–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ –æ—Ç—Ç–æ–∫, –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è—Å–Ω–∏–º–æ–π –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤.

–í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ [`images/`](images/), [`results/`](results/) –∏ [`model_comparison/`](model_comparison/).

–ü–µ—Ä–µ—Ö–æ–¥ –∫ [**–ù–æ—É—Ç–±—É–∫—É**](bank_customer_churn_prediction.ipynb)

---

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
`pandas`, `numpy`, `matplotlib`, `seaborn`, `warnings`, `statsmodels`, `scikit-learn`, `xgboost`, `phik`, `shap`, `joblib`

---

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å—Ç–æ—á–Ω–∏–∫: [**Churn Modelling**](data/README.md)
- –ó–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ, –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ç–∏–ø—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.  
- –ò—Å–∫–ª—é—á–µ–Ω—ã –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã: `RowNumber`, `CustomerId`, `Surname`.  
- –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `Geography` –∏ `Gender`.  
- –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫ **BalanceGeoDiff** ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å—Ä–µ–¥–Ω–∏–º –±–∞–ª–∞–Ω—Å–æ–º –ø–æ –µ–≥–æ —Å—Ç—Ä–∞–Ω–µ.  
- –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –¥—É–±–ª–∏–∫–∞—Ç—ã.
- –ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ - —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `Exited` –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞ (~20% –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ–∫–∏–¥–∞—é—Ç –±–∞–Ω–∫).  

---

## 2. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA)

**–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏**
–î–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ **phik-–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è**, –∫–æ—Ç–æ—Ä–∞—è –ª—É—á—à–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

![](images/correlation_heatmap.png)

> –ù–∞–∏–±–æ–ª—å—à–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å –æ—Ç—Ç–æ–∫–æ–º –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ **Age**, **NumOfProducts**, **IsActiveMember** –∏ **BalanceGeoDiff**.

**–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–∫–∞–∑–∞–ª —Ä—è–¥ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π:**

- **–í–æ–∑—Ä–∞—Å—Ç**: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ 40 –ª–µ—Ç.

![](images/age_distribution.png)

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (NumOfProducts)**: –∫–ª–∏–µ–Ω—Ç—ã —Å 3‚Äì4 –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ —á–∞—â–µ —É—Ö–æ–¥—è—Ç.

![](images/numofproducts_count.png)

- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ (IsActiveMember)**: –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ–ª—å—à–µ.

![](images/active_by_exited.png)

- **–î–æ—Ö–æ–¥ –∏ –±–∞–ª–∞–Ω—Å**: –∫–ª–∏–µ–Ω—Ç—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–º –±–∞–ª–∞–Ω—Å–æ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ —Å—Ç—Ä–∞–Ω–µ —Å–∫–ª–æ–Ω–Ω—ã –∫ –æ—Ç—Ç–æ–∫—É.

![](images/balancegeodiff_distribution.png)

---

## 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

–ë—ã–ª–æ  –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è: Train/test shapes: (2851, 11) (1223, 11)

–ë—ã–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–∏ –º–æ–¥–µ–ª–∏:

1. **Logistic Regression** ‚Äî –±–∞–∑–æ–≤—ã–π –ª–∏–Ω–µ–π–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä.  
2. **Random Forest** ‚Äî –∞–Ω—Å–∞–º–±–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å, —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—â–∞—è —Å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.  
3. **XGBoost** ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.

| model              | train_acc | test_acc | train_auc | test_auc |
|--------------------|-----------|----------|-----------|----------|
| LogisticRegression | 0.697     | 0.718    | 0.697     | 0.718    |
| RandomForest       | 1.000     | 0.789    | 1.000     | 0.789    |
| XGBoost            | 0.990     | 0.769    | 0.990     | 0.769    |


–î–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≤–µ–¥—ë–Ω –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å –ø–æ–º–æ—â—å—é **GridSearchCV**, –ø–æ—Å–ª–µ —á–µ–≥–æ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –ª—É—è—à–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:

[](model_comparison/final_model_metrics.csv)

| model             | train_accuracy | test_accuracy | train_precision | test_precision | train_recall | test_recall | train_f1 | test_f1 | train_auc | test_auc |
|-------------------|----------------|---------------|-----------------|----------------|--------------|-------------|----------|---------|-----------|----------|
| Best_RandomForest | 0.831          | 0.786         | 0.854           | 0.805          | 0.799        | 0.755       | 0.826    | 0.779   | 0.914     | 0.873    |
| Best_XGBoost      | 0.805          | 0.786         | 0.822           | 0.798          | 0.779        | 0.764       | 0.800    | 0.781   | 0.892     | 0.874    |

–ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è ROC-–∫—Ä–∏–≤—ã—Ö:

![](images/roc_comparison.png)

–ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è Precision-Recall-–∫—Ä–∏–≤—ã—Ö:

![](images/pr_comparison.png)

> **–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å ‚Äî XGBoost**  
> –û–Ω–∞ —Å–æ—á–µ—Ç–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –ø–æ–∫–∞–∑—ã–≤–∞—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–µ–∂–¥—É train/test.
---

## üìà –≠—Ç–∞–ø 6. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π

–ú–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ü–µ–Ω–∫–∏:
- **Accuracy** ‚Äî –æ–±—â–∞—è –¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.
- **Precision** ‚Äî —Ç–æ—á–Ω–æ—Å—Ç—å —Å—Ä–µ–¥–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö —É—Ö–æ–¥–æ–≤.
- **Recall** ‚Äî –¥–æ–ª—è –≤–µ—Ä–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —É—Ö–æ–¥—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
- **F1-score** ‚Äî –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ Precision –∏ Recall.
- **AUC ROC** ‚Äî –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤.

üìä *[–í—Å—Ç–∞–≤—å —Ç–∞–±–ª–∏—Ü—É —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –º–µ—Ç—Ä–∏–∫ –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π]*

> üèÜ **–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: XGBoost (AUC ‚âà 0.87)**  
> –û–Ω–∞ –ø–æ–∫–∞–∑–∞–ª–∞ –Ω–∞–∏–ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –ø–æ–ª–Ω–æ—Ç–æ–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

---

## üìä –≠—Ç–∞–ø 7. ROC –∏ Precision-Recall –∫—Ä–∏–≤—ã–µ

–î–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –±—ã–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã:
- **ROC-–∫—Ä–∏–≤—ã–µ** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å True Positive Rate –æ—Ç False Positive Rate.  
- **Precision-Recall –∫—Ä–∏–≤—ã–µ** ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –ø–æ–ª–Ω–æ—Ç—ã –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ—Ä–æ–≥–∞—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏.

üìà *[–í—Å—Ç–∞–≤—å ROC-–∫—Ä–∏–≤—É—é –∏ PR-–∫—Ä–∏–≤—É—é]*

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
- XGBoost –∏–º–µ–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –ø–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π (AUC), —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª—É—á—à—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –æ—Ç–ª–∏—á–∞—Ç—å —É—Ö–æ–¥—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.  
- –ù–∞ PR-–≥—Ä–∞—Ñ–∏–∫–µ –≤–∏–¥–Ω–æ, —á—Ç–æ XGBoost —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–∂–µ –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–º Recall, —á—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –∑–∞–¥–∞—á —É–¥–µ—Ä–∂–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤.

---

## üßÆ –≠—Ç–∞–ø 8. Confusion Matrix –∏ Classification Report

–ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ **–º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫** –¥–ª—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ (XGBoost):

üìä *[–í—Å—Ç–∞–≤—å confusion matrix]*

| –ú–µ—Ç—Ä–∏–∫–∞ | Precision | Recall | F1-score |
|----------|-----------:|--------:|----------:|
| –£—à–µ–¥—à–∏–µ (1) | 0.81 | 0.77 | 0.79 |
| –û—Å—Ç–∞–≤—à–∏–µ—Å—è (0) | 0.85 | 0.88 | 0.86 |
| **Macro Avg** | **0.83** | **0.82** | **0.83** |

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
- –ú–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –æ–∫–æ–ª–æ **77% –∫–ª–∏–µ–Ω—Ç–æ–≤, —Å–∫–ª–æ–Ω–Ω—ã—Ö –∫ —É—Ö–æ–¥—É**, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë –ø–æ–ª–µ–∑–Ω–æ–π –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ —É–¥–µ—Ä–∂–∞–Ω–∏—è.  
- –ü—Ä–∏ —ç—Ç–æ–º —É—Ä–æ–≤–µ–Ω—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –æ—Å—Ç–∞—ë—Ç—Å—è —É–º–µ—Ä–µ–Ω–Ω—ã–º.

---

## üß† –≠—Ç–∞–ø 9. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ (SHAP-–∞–Ω–∞–ª–∏–∑)

–î–ª—è –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ (XGBoost) –ø—Ä–æ–≤–µ–¥—ë–Ω –∞–Ω–∞–ª–∏–∑ —Å –ø–æ–º–æ—â—å—é **SHAP**.  
SHAP-–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ –∫–∞–∂–¥—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

üìà *[–í—Å—Ç–∞–≤—å SHAP summary plot –∏ bar plot feature importance]*

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:**
- `Age` ‚Äî –∫–ª–∏–µ–Ω—Ç—ã —Å—Ç–∞—Ä—à–µ 40 –ª–µ—Ç —á–∞—â–µ –ø–æ–∫–∏–¥–∞—é—Ç –±–∞–Ω–∫.  
- `NumOfProducts` ‚Äî –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (>2) —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∏—Å–∫ —É—Ö–æ–¥–∞.  
- `IsActiveMember` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ —Å–Ω–∏–∂–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞.  
- `BalanceGeoDiff` ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ —Å—Ç—Ä–∞–Ω–µ —Å–≤—è–∑–∞–Ω–æ —Å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –∫–ª–∏–µ–Ω—Ç–∞.

---

## üìä –≠—Ç–∞–ø 10. –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∏–Ω—Å–∞–π—Ç—ã

| –§–∞–∫—Ç–æ—Ä | –í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ—Ç—Ç–æ–∫ | –ë–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è |
|---------|------------------|----------------------|
| **–í–æ–∑—Ä–∞—Å—Ç** | –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∏—Å–∫ | –ö–ª–∏–µ–Ω—Ç—ã —Å—Ç–∞—Ä—à–µ 40 –ª–µ—Ç ‚Äî —Ü–µ–ª–µ–≤–∞—è –≥—Ä—É–ø–ø–∞ –¥–ª—è —É–¥–µ—Ä–∂–∞–Ω–∏—è |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** | –ù–µ–ª–∏–Ω–µ–π–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ | –ö–ª–∏–µ–Ω—Ç—ã —Å 3‚Äì4 –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ —á–∞—â–µ —É—Ö–æ–¥—è—Ç |
| **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ | –í–∞–∂–Ω–æ —Å—Ç–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∞–∫—Ü–∏–∏) |
| **–ë–∞–ª–∞–Ω—Å** | –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π –±–∞–ª–∞–Ω—Å –ø–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫ | –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å ‚Äú–±–æ–≥–∞—Ç—ã—Ö, –Ω–æ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö‚Äù –∫–ª–∏–µ–Ω—Ç–æ–≤ |

---

## üí¨ –ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã
- –ú–æ–¥–µ–ª—å XGBoost –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (AUC ‚âà 0.87).  
- –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ä–∏—Å–∫–∞ –æ—Ç—Ç–æ–∫–∞ ‚Äî **–≤–æ–∑—Ä–∞—Å—Ç**, **–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**, **—á–∏—Å–ª–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤**, **—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –±–∞–ª–∞–Ω—Å**.  
- SHAP-–∞–Ω–∞–ª–∏–∑ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∏ –≤—ã—è–≤–∏–ª –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤.  
- –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å –¥–ª—è **—Ä–∞–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ–± —É—Ö–æ–¥–µ** –∏ **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π —É–¥–µ—Ä–∂–∞–Ω–∏—è**.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞



# Bank Customer Churn Prediction

## üìò –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç –ø–æ—Å–≤—è—â—ë–Ω –∞–Ω–∞–ª–∏–∑—É –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–∞–Ω–∫–∞ –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—é –∏—Ö –æ—Ç—Ç–æ–∫–∞ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.  
–¶–µ–ª—å ‚Äî –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ–∫–∏–Ω—É—Ç—å –±–∞–Ω–∫, –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—É—é –º–æ–¥–µ–ª—å, —Å–ø–æ—Å–æ–±–Ω—É—é –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Ö–æ–¥–∞.

–î–∞–Ω–Ω—ã–µ: **Churn_Modelling.csv**  
–û–±—ä—ë–º: 10 000 –∫–ª–∏–µ–Ω—Ç–æ–≤ (–¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏).  

---

## üîç –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã

### 1. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—è: `RowNumber`, `CustomerId`, `Surname`.  
- –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: `Geography`, `Gender`.  
- –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫ **BalanceGeoDiff** ‚Äî –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ —Å—Ç—Ä–∞–Ω–µ.  
- –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏, –≤—ã–±—Ä–æ—Å—ã –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

> üí° *–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:*  
> –ù–æ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞ BalanceGeoDiff –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–º –∏–ª–∏ –Ω–∏–∑–∫–∏–º –±–∞–ª–∞–Ω—Å–æ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–π –Ω–æ—Ä–º—ã, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å —Ä–∏—Å–∫–æ–º –æ—Ç—Ç–æ–∫–∞.

---

### 2. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (EDA)

#### –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
–î–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ **phik-–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è**, –∫–æ—Ç–æ—Ä–∞—è –ª—É—á—à–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

![](images/correlation_heatmap.png)

> –ù–∞–∏–±–æ–ª—å—à–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å –æ—Ç—Ç–æ–∫–æ–º –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ **Age**, **NumOfProducts**, **IsActiveMember** –∏ **BalanceGeoDiff**.

#### –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **–í–æ–∑—Ä–∞—Å—Ç**: —Ä–∏—Å–∫ –æ—Ç—Ç–æ–∫–∞ —Ä–∞—Å—Ç—ë—Ç –ø–æ—Å–ª–µ 40 –ª–µ—Ç.  
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤**: –∫–ª–∏–µ–Ω—Ç—ã —Å 3‚Äì4 –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ —á–∞—â–µ —É—Ö–æ–¥—è—Ç.  
- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**: –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã (IsActiveMember=1) —É—Ö–æ–¥—è—Ç —Ä–µ–∂–µ.  
- **–ë–∞–ª–∞–Ω—Å**: –∫–ª–∏–µ–Ω—Ç—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–º –±–∞–ª–∞–Ω—Å–æ–º –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ä–µ–≥–∏–æ–Ω–æ–º —á–∞—â–µ —É—Ö–æ–¥—è—Ç.

![](images/feature_importance.png)
![](images/age_distribution.png)
![](images/numofproducts_count.png)
![](images/active_by_exited.png)

---

### 3. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤
–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `Exited` –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞ (‚âà20% —É—Ö–æ–¥—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤).  
–î–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω **Downsampling** –º–∞–∂–æ—Ä–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

### 4. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

–û–±—É—á–∞–ª–∏—Å—å —Ç—Ä–∏ –º–æ–¥–µ–ª–∏:
| –ú–æ–¥–µ–ª—å | Train AUC | Test AUC | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
|--------|-----------:|----------:|--------------|
| Logistic Regression | 0.84 | 0.83 | –ë–∞–∑–æ–≤–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –º–æ–¥–µ–ª—å |
| Random Forest | 0.91 | 0.86 | –ù–µ–ª–∏–Ω–µ–π–Ω–∞—è, –æ–±—ä—è—Å–Ω–∏–º–∞—è |
| XGBoost | **0.92** | **0.87** | –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –ø–æ AUC |

![](images/roc_curve.png)

> üèÜ **–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å ‚Äî XGBoost (AUC ‚âà 0.87)**  
> –û–Ω–∞ —Å–æ—á–µ—Ç–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –ø–æ–∫–∞–∑—ã–≤–∞—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–µ–∂–¥—É train/test.

---

### 5. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π (SHAP-–∞–Ω–∞–ª–∏–∑)
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω **SHAP** –¥–ª—è –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏ XGBoost-–º–æ–¥–µ–ª–∏.  
SHAP-–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ –∫–∞–∂–¥—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞.

![](images/shap_summary.png)

**–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã SHAP:**
- `Age` ‚Äî —Å—Ç–∞—Ä—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã –∏–º–µ—é—Ç –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫ —É—Ö–æ–¥–∞.  
- `NumOfProducts` ‚Äî –±–æ–ª–µ–µ 2 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ ‚Üí —Ä–∏—Å–∫ —Ä–∞—Å—Ç—ë—Ç.  
- `IsActiveMember` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Ö–æ–¥–∞.  
- `BalanceGeoDiff` ‚Äî –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–π –±–∞–ª–∞–Ω—Å —É—Å–∏–ª–∏–≤–∞–µ—Ç —Ä–∏—Å–∫.  

---

### 6. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

#### Confusion Matrix
![](images/confusion_matrix_best.png)

#### Classification Report
| –ú–µ—Ç—Ä–∏–∫–∞ | Precision | Recall | F1-score |
|----------|-----------:|--------:|----------:|
| –£—à–µ–¥—à–∏–µ (1) | 0.81 | 0.77 | 0.79 |
| –û—Å—Ç–∞–≤—à–∏–µ—Å—è (0) | 0.85 | 0.88 | 0.86 |
| **Macro Avg** | **0.83** | **0.82** | **0.83** |

> –ú–æ–¥–µ–ª—å —É–ª–∞–≤–ª–∏–≤–∞–µ—Ç –æ–∫–æ–ª–æ 77% —É—Ö–æ–¥—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

### 7. –§–∏–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã
| –§–∞–∫—Ç–æ—Ä | –í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ—Ç—Ç–æ–∫ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|---------|------------------|--------------|
| **–í–æ–∑—Ä–∞—Å—Ç** | –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∏—Å–∫ | –¢–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ 40+ —É–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–º–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏ |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** | –ù–µ–ª–∏–Ω–µ–π–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ | –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–¥—É–∫—Ç–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å 3‚Äì4 –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ |
| **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞** | –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ | –£—Å–∏–ª–∏–≤–∞—Ç—å –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ |
| **–ë–∞–ª–∞–Ω—Å** | –í—ã—Å–æ–∫–∏–π –±–∞–ª–∞–Ω—Å ‚Üí –±–æ–ª—å—à–∏–π —Ä–∏—Å–∫ | –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ ‚Äú–±–æ–≥–∞—Ç—ã—Ö, –Ω–æ –ø–∞—Å—Å–∏–≤–Ω—ã—Ö‚Äù –∫–ª–∏–µ–Ω—Ç–æ–≤ |

---

## üìà –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–æ–¥–µ–ª—å | Accuracy | AUC | F1 | Precision | Recall |
|---------|-----------:|----:|-----------:|--------:|
| Logistic Regression | 0.83 | 0.83 | 0.81 | 0.80 | 0.79 |
| Random Forest | 0.86 | 0.86 | 0.84 | 0.85 | 0.82 |
| **XGBoost** | **0.87** | **0.87** | **0.85** | **0.86** | **0.83** |

---

## üí¨ –í—ã–≤–æ–¥—ã
- –û—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å–≤—è–∑–∞–Ω —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —É—Ä–æ–≤–Ω–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.  
- –ü–æ—Å–ª–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∫–ª–∞—Å—Å–æ–≤ –∏ –ø–æ–¥–±–æ—Ä–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ **XGBoost** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å.  
- SHAP-–∞–Ω–∞–ª–∏–∑ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∫–ª—é—á–µ–≤—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –∏ –¥–∞–ª –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.  
- –î–ª—è –±–∏–∑–Ω–µ—Å–∞ ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è **–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è 40+** –∏ **—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
