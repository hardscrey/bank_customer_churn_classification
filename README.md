# bank_customer_churn-prediction

## üìò –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –±–∞–∑—ã –±–∞–Ω–∫–∞ –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â—É—é, –ø–æ–∫–∏–Ω–µ—Ç –ª–∏ –∫–ª–∏–µ–Ω—Ç –±–∞–Ω–∫.  
–ü—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –≤—ã—è–≤–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä–æ–≤, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ –æ—Ç—Ç–æ–∫, –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è—Å–Ω–∏–º–æ–π –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤.

–í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ [`images/`](images/), [`models/`](models/) –∏ [`model_comparison/`](model_comparison/).

–ü–µ—Ä–µ—Ö–æ–¥ –∫ [**–ù–æ—É—Ç–±—É–∫—É**](bank_customer_churn_prediction.ipynb)

---

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
`pandas`, `numpy`, `matplotlib`, `seaborn`, `warnings`, `statsmodels`, `scikit-learn`, `xgboost`, `phik`, `shap`, `joblib`

---

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ò—Å—Ç–æ—á–Ω–∏–∫: [**Churn Modelling**](data/README.md)
- –ó–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ, –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ç–∏–ø—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.  
- –ò—Å–∫–ª—é—á–µ–Ω—ã –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã: `RowNumber`, `CustomerId`, `Surname`.  
- –ó–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `Geography` –∏ `Gender`.  
- –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –ø—Ä–∏–∑–Ω–∞–∫ **BalanceGeoDiff** ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å—Ä–µ–¥–Ω–∏–º –±–∞–ª–∞–Ω—Å–æ–º –ø–æ –µ–≥–æ —Å—Ç—Ä–∞–Ω–µ.  
- –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –¥—É–±–ª–∏–∫–∞—Ç—ã.
- –ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ - —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `Exited` –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞ (~20% –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ–∫–∏–¥–∞—é—Ç –±–∞–Ω–∫).  

---

## 2. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA)

**–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏**
–î–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ **phik-–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è**, –∫–æ—Ç–æ—Ä–∞—è –ª—É—á—à–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

![](images/correlation_heatmap.png)

> –ù–∞–∏–±–æ–ª—å—à–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Å –æ—Ç—Ç–æ–∫–æ–º –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è —É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ **Age**, **NumOfProducts**, **IsActiveMember** –∏ **BalanceGeoDiff**.

**–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–∫–∞–∑–∞–ª —Ä—è–¥ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π:**

- **–í–æ–∑—Ä–∞—Å—Ç**: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ 40 –ª–µ—Ç.

![](images/age_distribution.png)

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (NumOfProducts)**: –∫–ª–∏–µ–Ω—Ç—ã —Å 3‚Äì4 –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ —á–∞—â–µ —É—Ö–æ–¥—è—Ç.

![](images/numofproducts_count.png)

- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ (IsActiveMember)**: –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ–ª—å—à–µ.

![](images/active_by_exited.png)

- **–î–æ—Ö–æ–¥ –∏ –±–∞–ª–∞–Ω—Å**: –∫–ª–∏–µ–Ω—Ç—ã —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–º –±–∞–ª–∞–Ω—Å–æ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ —Å—Ç—Ä–∞–Ω–µ —Å–∫–ª–æ–Ω–Ω—ã –∫ –æ—Ç—Ç–æ–∫—É.

![](images/balancegeodiff_distribution.png)

---

## 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

–ë—ã–ª–æ  –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –≤—ã–±–æ—Ä–∫–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è: Train/test shapes: (2851, 11) (1223, 11)

–ë—ã–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–∏ –º–æ–¥–µ–ª–∏:

1. **Logistic Regression** ‚Äî –±–∞–∑–æ–≤—ã–π –ª–∏–Ω–µ–π–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä.  
2. **Random Forest** ‚Äî –∞–Ω—Å–∞–º–±–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å, —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞—é—â–∞—è —Å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.  
3. **XGBoost** ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –æ–±–æ–±—â–∞—é—â–µ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.

| model              | train_acc | test_acc | train_auc | test_auc |
|--------------------|-----------|----------|-----------|----------|
| LogisticRegression | 0.697     | 0.718    | 0.697     | 0.718    |
| RandomForest       | 1.000     | 0.789    | 1.000     | 0.789    |
| XGBoost            | 0.990     | 0.769    | 0.990     | 0.769    |

---

## 4. –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π

–î–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –ø—Ä–æ–≤–µ–¥—ë–Ω –ø–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å –ø–æ–º–æ—â—å—é **GridSearchCV**, –ø–æ—Å–ª–µ —á–µ–≥–æ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –ª—É—è—à–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫:

–ú–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ü–µ–Ω–∫–∏:
- **Accuracy** ‚Äî –æ–±—â–∞—è –¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π.
- **Precision** ‚Äî —Ç–æ—á–Ω–æ—Å—Ç—å —Å—Ä–µ–¥–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö —É—Ö–æ–¥–æ–≤.
- **Recall** ‚Äî –¥–æ–ª—è –≤–µ—Ä–Ω–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —É—Ö–æ–¥—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
- **F1-score** ‚Äî –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ Precision –∏ Recall.
- **AUC ROC** ‚Äî –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤.

[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π](model_comparison/final_model_metrics.csv)

| model             | train_accuracy | test_accuracy | train_precision | test_precision | train_recall | test_recall | train_f1 | test_f1 | train_auc | test_auc |
|-------------------|----------------|---------------|-----------------|----------------|--------------|-------------|----------|---------|-----------|----------|
| Best_RandomForest | 0.831          | 0.786         | 0.854           | 0.805          | 0.799        | 0.755       | 0.826    | 0.779   | 0.914     | 0.873    |
| Best_XGBoost      | 0.805          | 0.786         | 0.822           | 0.798          | 0.779        | 0.764       | 0.800    | 0.781   | 0.892     | 0.874    |

**ROC-–∫—Ä–∏–≤—ã–µ** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å True Positive Rate –æ—Ç False Positive Rate.  
–ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è ROC-–∫—Ä–∏–≤—ã—Ö:

![](images/roc_comparison.png)

XGBoost –∏–º–µ–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –ø–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π (AUC), —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª—É—á—à—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –æ—Ç–ª–∏—á–∞—Ç—å —É—Ö–æ–¥—è—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.

**Precision-Recall –∫—Ä–∏–≤—ã–µ** ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –ø–æ–ª–Ω–æ—Ç—ã –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ—Ä–æ–≥–∞—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏.
–ì—Ä–∞—Ñ–∏–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è Precision-Recall-–∫—Ä–∏–≤—ã—Ö:

![](images/pr_comparison.png)

–ù–∞ PR-–≥—Ä–∞—Ñ–∏–∫–µ –≤–∏–¥–Ω–æ, —á—Ç–æ XGBoost —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–∂–µ –ø—Ä–∏ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–º Recall, —á—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –∑–∞–¥–∞—á —É–¥–µ—Ä–∂–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤.

**–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å ‚Äî XGBoost**: –û–Ω–∞ —Å–æ—á–µ—Ç–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –ø–æ–∫–∞–∑—ã–≤–∞—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–µ–∂–¥—É train/test.

---

## 5. Confusion Matrix –∏ Classification Report

–ü–æ—Å—Ç—Ä–æ–µ–Ω–∞ **–º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫** –¥–ª—è –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ (XGBoost):

![](images/confusion_matrix_best.png)

–¢–∞–±–ª–∏—Ü–∞ **Classification Report**

|              | precision | recall | f1-score | support |
|--------------|-----------|--------|----------|---------|
|              |           |        |          |         |
| 0            | 0.77      | 0.81   | 0.79     | 612     |
| 1            | 0.80      | 0.76   | 0.78     | 611     |
|              |           |        |          |         |
| accuracy     |           |        | 0.79     | 1223    |
| macro avg    | 0.79      | 0.79   | 0.79     | 1223    |
| weighted avg | 0.79      | 0.79   | 0.79     | 1223    |

–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
- –ú–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –æ–∫–æ–ª–æ 77% –∫–ª–∏–µ–Ω—Ç–æ–≤, —Å–∫–ª–æ–Ω–Ω—ã—Ö –∫ —É—Ö–æ–¥—É, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë –ø–æ–ª–µ–∑–Ω–æ–π –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ —É–¥–µ—Ä–∂–∞–Ω–∏—è.  
- –ü—Ä–∏ —ç—Ç–æ–º —É—Ä–æ–≤–µ–Ω—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –æ—Å—Ç–∞—ë—Ç—Å—è —É–º–µ—Ä–µ–Ω–Ω—ã–º.

---

## 6. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ (Feature importance –∏ SHAP-–∞–Ω–∞–ª–∏–∑)

Feature importance –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–µ–ø–µ–Ω—å –≤–ª–∏–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –Ω–∞ –æ—Ç—Ç–æ–∫:

![](images/feature_importance.png)

–î–ª—è –æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç–∏ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ (XGBoost) –ø—Ä–æ–≤–µ–¥—ë–Ω –∞–Ω–∞–ª–∏–∑ —Å –ø–æ–º–æ—â—å—é **SHAP**.  
SHAP-–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ –∫–∞–∂–¥—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

![](images/shap_summary.png)

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:**
- `Age` ‚Äî —Å—Ç–∞—Ä—à–∏–µ –∫–ª–∏–µ–Ω—Ç—ã –∏–º–µ—é—Ç –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫ —É—Ö–æ–¥–∞.  
- `NumOfProducts` ‚Äî –±–æ–ª–µ–µ 2 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Ä–∏—Å–∫ —É—Ö–æ–¥–∞.  
- `IsActiveMember` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ —Å–Ω–∏–∂–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ç—Ç–æ–∫–∞.  
- `BalanceGeoDiff` ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –ø–æ —Å—Ç—Ä–∞–Ω–µ —É–≤–µ–ª–∏—ã–∏–≤–∞–µ—Ç —Ä–∏—Å –æ—Ç—Ç–æ–∫–∞.

SHAP dependence –æ—Ç –í–æ–∑—Ä–∞—Å—Ç–∞ –∏ –ö–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏ –∏—Ö –≤–ª–∏—è–Ω–∏–µ:

–ì—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ SHAP –¥–ª—è –í–æ–∑—Ä–∞—Å—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ —Å –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é, –∞ —Ç–∞–∫–∂–µ —á—Ç–æ —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –≤–æ–∑—Ä–∞—Å—Ç–∞ (>40 –ª–µ—Ç) —Ä–∏—Å–∫ –æ—Ç—Ç–æ–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –ø—Ä–∏ —ç—Ç–æ–º –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ —Å–ø–æ—Å–æ–±–Ω–∞ —É–º–µ–Ω—å—à–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞.

![](images/shap_dependence_Age.png)

–ì—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ SHAP –¥–ª—è –ö–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–¥—É–∫—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ —Å –†–∞–∑–Ω–∏—Ü–µ–π –±–∞–ª–∞–Ω—Å–∞ –ø–æ —Å—Ç—Ä–∞–Ω–µ –∏ —Å–º—è–≥—á–∞—é—â–µ–µ –≤–ª–∏—è–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å 1 –∏ 2 –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏.

![](images/shap_dependence_NumOfProducts.png)

---

## 7. –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –∏–Ω—Å–∞–π—Ç—ã

| –§–∞–∫—Ç–æ—Ä | –í–ª–∏—è–Ω–∏–µ –Ω–∞ –æ—Ç—Ç–æ–∫ | –ë–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è |
|---------|------------------|----------------------|
| **–í–æ–∑—Ä–∞—Å—Ç** | –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∏—Å–∫ | –ö–ª–∏–µ–Ω—Ç—ã —Å—Ç–∞—Ä—à–µ 40 –ª–µ—Ç ‚Äî —Ü–µ–ª–µ–≤–∞—è –≥—Ä—É–ø–ø–∞ –¥–ª—è —É–¥–µ—Ä–∂–∞–Ω–∏—è |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** |  –ù–µ–ª–∏–Ω–µ–π–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ | –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–¥—É–∫—Ç–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å 3‚Äì4 –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏ |
| **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ | –£—Å–∏–ª–∏–≤–∞—Ç—å –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| **–ë–∞–ª–∞–Ω—Å** | –í—ã—Å–æ–∫–∏–π –±–∞–ª–∞–Ω—Å –ø–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫ | –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å ‚Äú–±–æ–≥–∞—Ç—ã—Ö, –Ω–æ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö‚Äù –∫–ª–∏–µ–Ω—Ç–æ–≤ |

**–ò—Ç–æ–≥–æ–≤—ã–µ –≤—ã–≤–æ–¥—ã**
- –ú–æ–¥–µ–ª—å XGBoost –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.  
- –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ä–∏—Å–∫–∞ –æ—Ç—Ç–æ–∫–∞ ‚Äî **–≤–æ–∑—Ä–∞—Å—Ç**, **–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**, **—á–∏—Å–ª–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤**, **—Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –±–∞–ª–∞–Ω—Å**.  
- SHAP-–∞–Ω–∞–ª–∏–∑ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ –∏ –≤—ã—è–≤–∏–ª –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤.  
- –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å –¥–ª—è **—Ä–∞–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ–± —É—Ö–æ–¥–µ** –∏ **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞—Ä–≥–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π —É–¥–µ—Ä–∂–∞–Ω–∏—è**.
